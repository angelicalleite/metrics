<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Mon Jan 06 16:40:44 CET 2014 -->
<meta http-equiv="Content-Type" content="text/html" charset="UTF-8">
<title>DensityCubeCallback (Metrics :: CLI 0.13-SNAPSHOT API)</title>
<meta name="date" content="2014-01-06">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="DensityCubeCallback (Metrics :: CLI 0.13-SNAPSHOT API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../org/gbif/metrics/cli/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DensityCubeCallback.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/gbif/metrics/cli/Application.OccurrenceDatasetTaxonCubeCommand.html" title="class in org.gbif.metrics.cli"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/gbif/metrics/cli/GangliaConfiguration.html" title="class in org.gbif.metrics.cli"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/gbif/metrics/cli/DensityCubeCallback.html" target="_top">Frames</a></li>
<li><a href="DensityCubeCallback.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.gbif.metrics.cli</div>
<h2 title="Class DensityCubeCallback" class="title">Class DensityCubeCallback</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.gbif.common.messaging.AbstractMessageCallback&lt;org.gbif.common.messaging.api.messages.OccurrenceMutatedMessage&gt;</li>
<li>
<ul class="inheritance">
<li>org.gbif.metrics.cli.DensityCubeCallback</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>org.gbif.common.messaging.api.MessageCallback&lt;org.gbif.common.messaging.api.messages.OccurrenceMutatedMessage&gt;</dd>
</dl>
<hr>
<br>
<pre>public class <a href="../../../../src-html/org/gbif/metrics/cli/DensityCubeCallback.html#line.35">DensityCubeCallback</a>
extends org.gbif.common.messaging.AbstractMessageCallback&lt;org.gbif.common.messaging.api.messages.OccurrenceMutatedMessage&gt;</pre>
<div class="block">The callback for handling messages for density tile updates.

 NOTE: It is intended that only 1 be registered per queue.

 This configures an asynchronously flushing datacube using say N threads and a batch size of S.
 To ensure no contention, this will build a buffer of updates of size N*(S+1) before paritioning
 into N batches of size (S+1) and writing to DataCube.  By doing this, we know that datacube will
 flush them immediately.

 This is designed so that we can have numerous HBase flushing threads, which is required for any
 kind of performance, but ensure that they will never compete for updating cells.

 This class is threadsafe and stateful, but not intended to be used in multithreaded manner as it
 uses synchronized locks.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../org/gbif/metrics/cli/DensityCubeCallback.html#DensityCubeCallback(org.gbif.metrics.cli.DensityCubeConfiguration, org.apache.hadoop.conf.Configuration)">DensityCubeCallback</a></strong>(org.gbif.metrics.cli.DensityCubeConfiguration&nbsp;configuration,
                                      org.apache.hadoop.conf.Configuration&nbsp;hadoopConfiguration)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/gbif/metrics/cli/DensityCubeCallback.html#close()">close</a></strong>()</code>
<div class="block">Closes the underlying datacube instance.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected com.urbanairship.datacube.Batch&lt;<a href="http://github.org/gbif/metrics/cube/apidocs/org/gbif/metrics/cube/tile/density/DensityTile.html?is-external=true" title="class or interface in org.gbif.metrics.cube.tile.density">DensityTile</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/gbif/metrics/cli/DensityCubeCallback.html#getNewMutations(org.gbif.api.model.occurrence.Occurrence)">getNewMutations</a></strong>(org.gbif.api.model.occurrence.Occurrence&nbsp;occurrence)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected com.urbanairship.datacube.Batch&lt;<a href="http://github.org/gbif/metrics/cube/apidocs/org/gbif/metrics/cube/tile/density/DensityTile.html?is-external=true" title="class or interface in org.gbif.metrics.cube.tile.density">DensityTile</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/gbif/metrics/cli/DensityCubeCallback.html#getUpdateMutations(org.gbif.api.model.occurrence.Occurrence, org.gbif.api.model.occurrence.Occurrence)">getUpdateMutations</a></strong>(org.gbif.api.model.occurrence.Occurrence&nbsp;oldOccurrence,
                                    org.gbif.api.model.occurrence.Occurrence&nbsp;newOccurrence)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/gbif/metrics/cli/DensityCubeCallback.html#handleMessage(org.gbif.common.messaging.api.messages.OccurrenceMutatedMessage)">handleMessage</a></strong>(org.gbif.common.messaging.api.messages.OccurrenceMutatedMessage&nbsp;message)</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/gbif/metrics/cli/DensityCubeCallback.html#resetInactiveWatcher()">resetInactiveWatcher</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/gbif/metrics/cli/DensityCubeCallback.html#startInactiveWatcher()">startInactiveWatcher</a></strong>()</code>
<div class="block">Starts an inactive watcher if there is not one already running.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_org.gbif.common.messaging.AbstractMessageCallback">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;org.gbif.common.messaging.AbstractMessageCallback</h3>
<code>getMessageClass</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="DensityCubeCallback(org.gbif.metrics.cli.DensityCubeConfiguration, org.apache.hadoop.conf.Configuration)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DensityCubeCallback</h4>
<pre>public&nbsp;<a href="../../../../src-html/org/gbif/metrics/cli/DensityCubeCallback.html#line.42">DensityCubeCallback</a>(org.gbif.metrics.cli.DensityCubeConfiguration&nbsp;configuration,
                   org.apache.hadoop.conf.Configuration&nbsp;hadoopConfiguration)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/gbif/metrics/cli/DensityCubeCallback.html#line.57">close</a>()</pre>
<div class="block">Closes the underlying datacube instance.</div>
</li>
</ul>
<a name="getNewMutations(org.gbif.api.model.occurrence.Occurrence)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNewMutations</h4>
<pre>protected&nbsp;com.urbanairship.datacube.Batch&lt;<a href="http://github.org/gbif/metrics/cube/apidocs/org/gbif/metrics/cube/tile/density/DensityTile.html?is-external=true" title="class or interface in org.gbif.metrics.cube.tile.density">DensityTile</a>&gt;&nbsp;<a href="../../../../src-html/org/gbif/metrics/cli/DensityCubeCallback.html#line.85">getNewMutations</a>(org.gbif.api.model.occurrence.Occurrence&nbsp;occurrence)</pre>
</li>
</ul>
<a name="getUpdateMutations(org.gbif.api.model.occurrence.Occurrence, org.gbif.api.model.occurrence.Occurrence)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getUpdateMutations</h4>
<pre>protected&nbsp;com.urbanairship.datacube.Batch&lt;<a href="http://github.org/gbif/metrics/cube/apidocs/org/gbif/metrics/cube/tile/density/DensityTile.html?is-external=true" title="class or interface in org.gbif.metrics.cube.tile.density">DensityTile</a>&gt;&nbsp;<a href="../../../../src-html/org/gbif/metrics/cli/DensityCubeCallback.html#line.91">getUpdateMutations</a>(org.gbif.api.model.occurrence.Occurrence&nbsp;oldOccurrence,
                                                              org.gbif.api.model.occurrence.Occurrence&nbsp;newOccurrence)</pre>
</li>
</ul>
<a name="handleMessage(org.gbif.common.messaging.api.messages.OccurrenceMutatedMessage)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleMessage</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/gbif/metrics/cli/CubeUpdaterCallback.html#line.45">handleMessage</a>(org.gbif.common.messaging.api.messages.OccurrenceMutatedMessage&nbsp;message)</pre>
</li>
</ul>
<a name="resetInactiveWatcher()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>resetInactiveWatcher</h4>
<pre>protected&nbsp;void&nbsp;<a href="../../../../src-html/org/gbif/metrics/cli/CubeUpdaterCallback.html#line.94">resetInactiveWatcher</a>()</pre>
</li>
</ul>
<a name="startInactiveWatcher()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>startInactiveWatcher</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/gbif/metrics/cli/CubeUpdaterCallback.html#line.103">startInactiveWatcher</a>()</pre>
<div class="block">Starts an inactive watcher if there is not one already running.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../org/gbif/metrics/cli/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/DensityCubeCallback.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/gbif/metrics/cli/Application.OccurrenceDatasetTaxonCubeCommand.html" title="class in org.gbif.metrics.cli"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/gbif/metrics/cli/GangliaConfiguration.html" title="class in org.gbif.metrics.cli"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/gbif/metrics/cli/DensityCubeCallback.html" target="_top">Frames</a></li>
<li><a href="DensityCubeCallback.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2014 <a href="http://www.gbif.org">Global Biodiversity Information Facility</a>. All rights reserved.</small></p>
</body>
</html>
